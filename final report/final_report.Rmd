---
title: "**The predictive capacity of Google Trends:**"
subtitle: "Italian parliamentary election of 2022"
author: "Francesca Martinoli"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Github repository [Capstone_Gtrends_ITAElection](https://github.com/DataAccess2020/Capstone_Gtrends_ITAElection.git)


## **Introduction**

Polls and data analysis have always been widely used during electoral campaigns; the recent spread of the internet has allowed access to large amounts of new data. In this scenario, many studies have shown the elevate predictive capacity of Google Trends, as a tool for making data prediction either in social, economic or health field.

## **Question research**

Inspired by a [*Prado-Román's study*]{.underline} - ([Google Trends as a Predictor of Presidential Elections: the United States versus Canada](https://journals.sagepub.com/doi/pdf/10.1177/0002764220975067?download=true)), this project proposes to testing the hypothesis that the Google Trends tool have an elevate predictive capacity in anticipate the winner of the elections. The aim of this little study is to demonstrate the ability of Google Trends as a predictor of the winner of the Italian parliamentary election of 2022.

## **Data and Tools**

In order to get the data I need for my analysis, I used the [Google Trends](https://trends.google.it/trends/?geo=IT) API provided by Google, which allows to get data about search volume for single search terms or comparisons, over a selected time period. The results are return in a standardized measure: Google assign a measure of popularity to search terms, scaled between 0 and 100.

To interact with Google Trends API I used the `gtrendsR` package ([more info](https://github.com/PMassicotte/gtrendsR)), that allows to get data from Google Trends and displays them into a dataset with many information about interest over time (search volume), interest by country, region or city, related topics and related queries. For my purpose, I only used the data about `interest over time`, which contain information about the search volume for the single search terms I am interest in.

In this project I decided to analyze the data from the July 21st 2022, the day news elections were announced by President Mattarella, and the September 25th 2022, the "election day": they are the months of electoral campaigns.

For the analysis I transformed the variable `hits` into a numeric variable `hit_score`, recoding the value "\< 1" into zero.

## **Exploratory analysis**

At first, I chose to explore the single research terms for each relevant political actor of the 2022 election: I compared the `surname` and `name + surname` of the party leader, the `party name` and sometimes the party's `acronym`.

```{r echo=FALSE, message = F, warning = F, fig.align = 'center', fig.dim = c(9, 4)}
library(rio)
library(ggplot2)
library(tidyverse)
library(plyr)
library(lubridate)
library(plotly)

data.meloni <- import(here::here("data/meloni_keywords.csv"))

data.meloni$date <- as_date(data.meloni$date)

meloni_plot <- ggplot(data.meloni, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Giorgia Meloni", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
           plot.subtitle = element_text(hjust = 0.5),
        legend.position = "Bottom")

ggplotly(meloni_plot)
```

For Matteo Salvini I decided to include also the old party name "Lega Nord", that sometimes results more searched than the actual name "Lega per Salvini premier". 

```{r echo=FALSE, message = F, warning = F, fig.align = 'center', fig.dim = c(9, 4)}
data.salvini <- import(here::here("data/salvini_keywords.csv"))

data.salvini$date <- as_date(data.salvini$date)

salvini_plot <- ggplot(data.salvini, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2", "gold3"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Matteo Salvini", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))

ggplotly(salvini_plot)

data.berlu <- import(here::here("data/berlusconi_keywords.csv"))
data.berlu$date <- as_date(data.berlu$date)

berlu_plot <- ggplot(data.berlu, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Silvio Berlusconi", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
ggplotly(berlu_plot)


data.letta <- import(here::here("data/letta_keywords.csv"))
data.letta$date <- as_date(data.letta$date)

letta_plot <- ggplot(data.letta, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2", "gold3"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Enrico Letta", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))

ggplotly(letta_plot)

data.conte <- import(here::here("data/conte_keywords.csv"))
data.conte$date <- as_date(data.conte$date)

conte_plot <- ggplot(data.conte, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2", "gold3"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Giuseppe Conte", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
ggplotly(conte_plot)


data.3polo <- import(here::here("data/terzopolo_keywords.csv"))
data.3polo$date <- as_date(data.3polo$date)

terzopolo_plot <- ggplot(data.3polo, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple", "deepskyblue3", "darkorange2", "gold3"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Terzo polo", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
ggplotly(terzopolo_plot)

```

For Enrico Letta and Giuseppe Conte I chose to include also the acronym of the party, which are the most used in the common language and also by the media.
Moreover, I decide to analyze Matteo Renzi and Carlo Calenda at the same time, since they ran together in the elections; I also included the term "terzo polo" which is an informal way used by the media to indicate their coalition.

It is interesting to note that the surnames are usually the most searched term for each actor, expect for Enrico Letta: we can see that the acronym "pd" was more searched than "Letta". we can hypothesize that it is due to a minor personalization of his party, compared with the populist parties in the competition.

## **Comparison and Results**

It is important to notice that the previous studies on the predictive capacity of Google Trends usually focused on presidential elections, which usually include only two candidates and are characterized by high political personalisation.
In this project I decided to analyze the italian parliamentary election, which includes many political actors and are characterized by low political personalization (compared to presidential elections). 

In order to compare the different political actors, I decided to use the leader's `surname`, which I notice is the most used term for each actor (expect for Letta), and not `name + surname` as it was done by [*Prado-Román*]{.underline} in his study. 

```{r echo=FALSE, message = F, warning = F, fig.align = 'center', fig.dim = c(9, 4)}


merge_data <- import(here::here("data/all_keywords_complete.csv"))

merge_data$date <- as_date(merge_data$date)

leaders_plot <- ggplot(merge_data, aes(y = hits_score, x = date, group = keyword, color=keyword)) +
  geom_line(size=1) +
  scale_color_manual(values = c("purple3", "deepskyblue3", "darkorange2", "gold3", "orchid3", "royalblue4", "chartreuse4"), "keyword") +
  ylab("hits") +
  xlab("date") +
  ggtitle("Comparison between leaders", subtitle = "interest over time") +
  scale_x_date(date_labels = "%d %b %Y", date_breaks = "10 days") +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))

ggplotly(leaders_plot)
```





